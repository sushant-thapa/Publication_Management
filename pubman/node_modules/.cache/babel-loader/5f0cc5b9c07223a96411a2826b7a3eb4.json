{"ast":null,"code":"import * as jsPDF from 'jspdf';\nimport * as Blob from 'blob';\n\nfunction downloader(JsonData, bibFormat, fileFormat) {\n  console.log(JsonData, bibFormat, fileFormat);\n  JsonData = JsonData.toLowerCase();\n\n  if (bibFormat === 'mla') {\n    var mlastr = \"<html><body style= 'font-family:Times New Roman font-size: 12px'>\";\n\n    for (var i = 0; i < JsonData.length; i++) {\n      mlastr += \"<p>\";\n      mlastr += '[' + (i + 1).toString() + \"] \";\n      var authorsList = JsonData[i].authors.split(\",\");\n\n      for (var j = 0; j < authorsList.length; j++) {\n        var authorstr = authorsList[j];\n        var authorstrList = authorstr.split(' ');\n        mlastr += authorstrList[authorstrList.length - 1] + \", \";\n\n        for (var abc = 0; abc < authorstrList.length - 2; abc++) {\n          mlastr += authorstrList[abc] + ' ';\n        }\n\n        if (authorstrList.length >= 2) {\n          mlastr += authorstrList[authorstrList.length - 2];\n        }\n\n        if (j == authorsList.length - 2) {\n          mlastr += \", and \";\n        } else if (j < authorsList.length - 2) {\n          mlastr += \", \";\n        }\n      }\n\n      mlastr += \". <i>\" + JsonData[i].title + \". </i>\";\n      mlastr += JsonData[i].city + \": \" + JsonData[i].publisher;\n      mlastr += \". \" + JsonData[i].year;\n      mlastr += \"</p>\";\n    }\n\n    mlastr += \"</body></html>\";\n\n    if (fileFormat === 'pdf') {\n      var doc = new jsPDF('p', 'pt', 'letter');\n      doc.fromHTML(mlastr, 45, 30, {\n        width: 517\n      }); //Convert html string into jsPDF instances\n\n      doc.save('MLA.pdf');\n    }\n\n    if (fileFormat === 'docx') {\n      var blob = new Blob(['\\ufeff', mlastr], {\n        //converts html string into blob(Binary Large Object) of type msword\n        type: 'application/msword'\n      });\n      var url = 'data:application/vnd.ms-word;charset=utf-8,' + encodeURIComponent(mlastr);\n      var filename = \"MLA.docx\"; //file is downloaded as MLA.docx, user can change it while downloading\n\n      var downloadLink = document.createElement(\"a\");\n      document.body.appendChild(downloadLink);\n\n      if (navigator.msSaveOrOpenBlob) {\n        navigator.msSaveOrOpenBlob(blob, filename);\n      } else {\n        downloadLink.href = url;\n        downloadLink.download = filename;\n        downloadLink.click();\n      }\n\n      document.body.removeChild(downloadLink);\n    }\n\n    if (fileFormat === 'html') {\n      var element = document.createElement('a');\n      element.setAttribute('href', 'data:text/plain;charset=utf-8,' + encodeURIComponent(mlastr));\n      element.setAttribute('download', \"MLA.html\");\n      element.style.display = 'none';\n      document.body.appendChild(element);\n      element.click();\n      document.body.removeChild(element);\n    }\n  }\n\n  if (bibFormat == 'apa') {\n    var apastr = \"<html><body style= 'font-family:Times New Roman font-size: 12px'>\"; //apa formatted html string\n\n    for (var i = 0; i < JsonData.length; i++) {\n      //This loop prepares required html string\n      apastr += \"<p>\";\n      apastr += '[' + (i + 1).toString() + \"] \";\n      var authorsList = JsonData[i].authors.split(\",\");\n\n      for (var j = 0; j < authorsList.length; j++) {\n        var authorstr = authorsList[j];\n        var authorstrList = authorstr.split(' ');\n        apastr += authorstrList[authorstrList.length - 1] + \", \";\n\n        for (var abc = 0; abc < authorstrList.length - 2; abc++) {\n          if (authorstr[0] == ' ' && abc == 0) continue;\n          apastr += authorstrList[abc][0] + '. ';\n        }\n\n        if (authorstrList.length >= 2) {\n          apastr += authorstrList[authorstrList.length - 2][0] + '.';\n        }\n\n        if (j == authorsList.length - 2) {\n          apastr += \", & \";\n        } else if (j < authorsList.length - 2) {\n          apastr += \", \";\n        }\n      }\n\n      apastr += \". (\" + JsonData[i].year + \")\";\n      apastr += \". <i>\" + JsonData[i].title + \". </i>\";\n      apastr += JsonData[i].city + \": \" + JsonData[i].publisher;\n      apastr += \"</p>\";\n    }\n\n    apastr += \"</body></html>\";\n\n    if (fileFormat === 'pdf') {\n      var doc = new jsPDF('p', 'pt', 'letter');\n      doc.fromHTML(apastr, 45, 30, {\n        width: 517\n      }); //Convert html string into jsPDF instances\n\n      doc.save('APA.pdf');\n    }\n\n    if (fileFormat === 'docx') {\n      var blob = new Blob(['\\ufeff', apastr], {\n        //converts html string into blob(Binary Large Object) of type msword\n        type: 'application/msword'\n      });\n      var url = 'data:application/vnd.ms-word;charset=utf-8,' + encodeURIComponent(apastr);\n      var filename = \"APA.docx\"; //file is downloaded as MLA.docx, user can change it while downloading\n\n      var downloadLink = document.createElement(\"a\");\n      document.body.appendChild(downloadLink);\n\n      if (navigator.msSaveOrOpenBlob) {\n        navigator.msSaveOrOpenBlob(blob, filename);\n      } else {\n        downloadLink.href = url;\n        downloadLink.download = filename;\n        downloadLink.click();\n      }\n\n      document.body.removeChild(downloadLink);\n    }\n\n    if (fileFormat === 'html') {\n      var element = document.createElement('a');\n      element.setAttribute('href', 'data:text/plain;charset=utf-8,' + encodeURIComponent(apastr));\n      element.setAttribute('download', \"APA.html\");\n      element.style.display = 'none';\n      document.body.appendChild(element);\n      element.click();\n      document.body.removeChild(element);\n    }\n  }\n\n  if (bibFormat === 'ieee') {\n    var ieeestr = \"<html><body style= 'font-family:Times New Roman; font-size: 11px'>\"; //ieee formatted html string                                                                       //str is a html string\n\n    for (var i = 0; i < JsonData.length; i++) {\n      ieeestr += \"<p>\";\n      ieeestr += '[' + (i + 1).toString() + \"] \";\n      var authorsList = JsonData[i].authors.split(\",\");\n\n      for (var j = 0; j < authorsList.length; j++) {\n        var authorstr = authorsList[j];\n        var authorstrList = authorstr.split(' ');\n\n        if (authorstrList.length > 1) {\n          if (authorstr[0] != ' ') {\n            ieeestr += authorstrList[0][0] + \". \";\n            var star = 1;\n          } else {\n            ieeestr += authorstrList[1][0] + \". \";\n            var star = 2;\n          }\n        } else ieeestr += authorstrList[0] + \". \";\n\n        for (var abc = star; abc <= authorstrList.length - 2; abc++) {\n          ieeestr += authorstrList[abc][0] + '. ';\n        }\n\n        ieeestr += authorstrList[authorstrList.length - 1];\n\n        if (j == authorsList.length - 2) {\n          ieeestr += \", and \";\n        } else if (j < authorsList.length - 2) {\n          ieeestr += \", \";\n        }\n      }\n\n      ieeestr += \", <i>\" + JsonData[i].title + \", </i>\";\n      ieeestr += JsonData[i].city + \": \" + JsonData[i].publisher;\n      ieeestr += \", \" + JsonData[i].year;\n      ieeestr += \"</p>\";\n    }\n\n    ieeestr += \"</body></html>\";\n\n    if (fileFormat === 'pdf') {\n      var doc = new jsPDF('p', 'pt', 'letter');\n      doc.fromHTML(ieeestr, 45, 30, {\n        width: 517\n      }); //Convert html string into jsPDF instances\n\n      doc.save('IEEE.pdf');\n    }\n\n    if (fileFormat === 'docx') {\n      var blob = new Blob(['\\ufeff', ieeestr], {\n        //converts html string into blob(Binary Large Object) of type msword\n        type: 'application/msword'\n      });\n      var url = 'data:application/vnd.ms-word;charset=utf-8,' + encodeURIComponent(ieeestr);\n      var filename = \"IEEE.docx\"; //file is downloaded as MLA.docx, user can change it while downloading\n\n      var downloadLink = document.createElement(\"a\");\n      document.body.appendChild(downloadLink);\n\n      if (navigator.msSaveOrOpenBlob) {\n        navigator.msSaveOrOpenBlob(blob, filename);\n      } else {\n        downloadLink.href = url;\n        downloadLink.download = filename;\n        downloadLink.click();\n      }\n\n      document.body.removeChild(downloadLink);\n    }\n\n    if (fileFormat === 'html') {\n      var element = document.createElement('a');\n      element.setAttribute('href', 'data:text/plain;charset=utf-8,' + encodeURIComponent(ieeestr));\n      element.setAttribute('download', \"IEEE.html\");\n      element.style.display = 'none';\n      document.body.appendChild(element);\n      element.click();\n      document.body.removeChild(element);\n    }\n  }\n}\n\nexport default downloader;","map":{"version":3,"sources":["/home/sandesh/projects/pubman/src/database/downloader.js"],"names":["jsPDF","Blob","downloader","JsonData","bibFormat","fileFormat","console","log","toLowerCase","mlastr","i","length","toString","authorsList","authors","split","j","authorstr","authorstrList","abc","title","city","publisher","year","doc","fromHTML","width","save","blob","type","url","encodeURIComponent","filename","downloadLink","document","createElement","body","appendChild","navigator","msSaveOrOpenBlob","href","download","click","removeChild","element","setAttribute","style","display","apastr","ieeestr","star"],"mappings":"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","sourcesContent":["import * as jsPDF from 'jspdf';\nimport * as Blob from 'blob';\n\nfunction downloader(JsonData, bibFormat, fileFormat){\n    console.log(JsonData, bibFormat, fileFormat);\n    JsonData = JsonData.toLowerCase();\n    if(bibFormat === 'mla'){\n         var mlastr       = \"<html><body style= 'font-family:Times New Roman font-size: 12px'>\";\t\n\t\tfor(var i=0; i<JsonData.length; i++){\t\t\t\t                    \t\t\t\n            mlastr += \"<p>\";\n            mlastr += '['+(i+1).toString()+\"] \";\n            var authorsList = JsonData[i].authors.split(\",\");\n\t\t\tfor(var j= 0; j<authorsList.length; j++){\n                var authorstr = authorsList[j];\n                var authorstrList = authorstr.split(' ');\n                mlastr += authorstrList[authorstrList.length -1]+\", \";\n                for(var abc = 0; abc < authorstrList.length -2 ; abc ++){\n                    mlastr += authorstrList[abc]+' ';\n                }\n                if(authorstrList.length >= 2){\n                    mlastr += authorstrList[authorstrList.length - 2]\n                }\n\t\t\t\tif(j == authorsList.length - 2){\n\t\t\t\t\tmlastr += \", and \";\n\t\t\t\t}\n\t\t\t\telse if(j < authorsList.length - 2){\n\t\t\t\t\tmlastr += \", \";\n\t\t\t\t}\n\t\t\t}\n\t\t\tmlastr += \". <i>\"+JsonData[i].title+\". </i>\";\n\t\t\tmlastr += JsonData[i].city + \": \" + JsonData[i].publisher;\n\t\t\tmlastr += \". \"+JsonData[i].year;\n\t\t\tmlastr += \"</p>\";                     \n\t\t}\n        mlastr += \"</body></html>\";\n        if(fileFormat === 'pdf'){\n            var doc = new jsPDF('p', 'pt', 'letter');\n\t\t    doc.fromHTML(mlastr, 45, 30, {width: 517});\t\t\t\t\t                  \t         \t\t//Convert html string into jsPDF instances\n\t\t    doc.save('MLA.pdf');\n        }\n        if(fileFormat === 'docx'){\n            var blob = new Blob(['\\ufeff', mlastr], {\t\t\t\t                    \t\t//converts html string into blob(Binary Large Object) of type msword\n                type: 'application/msword'\n                });\n                var url = 'data:application/vnd.ms-word;charset=utf-8,' + encodeURIComponent(mlastr);\n                var filename = \"MLA.docx\";\t\t\t\t\t\t                                 \t\t//file is downloaded as MLA.docx, user can change it while downloading\n                var downloadLink = document.createElement(\"a\");\t\t\t\n                document.body.appendChild(downloadLink);\n                if(navigator.msSaveOrOpenBlob ){\n                    navigator.msSaveOrOpenBlob(blob, filename);\n                }else{\n                    downloadLink.href = url;\n                    downloadLink.download = filename;\n                    downloadLink.click();\n                }\n                document.body.removeChild(downloadLink);\n        }\n        if(fileFormat === 'html'){\n            var element = document.createElement('a');\n            element.setAttribute('href', 'data:text/plain;charset=utf-8,' + encodeURIComponent(mlastr));\n            element.setAttribute('download', \"MLA.html\");\n            element.style.display = 'none';\n            document.body.appendChild(element);\n            element.click();\n            document.body.removeChild(element);\n        }\n    }\n    if(bibFormat == 'apa'){\n        var apastr       = \"<html><body style= 'font-family:Times New Roman font-size: 12px'>\";\t//apa formatted html string\n\t\tfor(var i=0; i<JsonData.length; i++){\t\t\t\t                    \t\t\t//This loop prepares required html string\n            apastr += \"<p>\";\n            apastr += '['+(i+1).toString()+\"] \";\n            var authorsList = JsonData[i].authors.split(\",\");\n\t\t\tfor(var j= 0; j<authorsList.length; j++){\n                var authorstr = authorsList[j];\n                var authorstrList = authorstr.split(' ');\n                apastr += authorstrList[authorstrList.length -1]+\", \";\n                for(var abc = 0; abc < authorstrList.length -2 ; abc ++){\n                    if(authorstr[0] == ' ' && abc == 0)\n                        continue;\n                  apastr +=   authorstrList[abc][0]+'. ';\n                }\n                  if(authorstrList.length >= 2){\n                        apastr += authorstrList[authorstrList.length - 2][0]+'.';\n                    }\n                    if(j == authorsList.length - 2){\n                        apastr += \", & \";\n                    }\n                    else if(j < authorsList.length - 2){\n                        apastr += \", \";\n                    }\n                }\n\t        apastr += \". (\"+JsonData[i].year+\")\";\n            apastr += \". <i>\"+JsonData[i].title+\". </i>\"\n\t        apastr += JsonData[i].city + \": \" + JsonData[i].publisher;\n            apastr += \"</p>\";\n        }\n        apastr += \"</body></html>\";\n        if(fileFormat === 'pdf'){\n            var doc = new jsPDF('p', 'pt', 'letter');\n\t\t    doc.fromHTML(apastr, 45, 30, {width: 517});\t\t\t\t\t                  \t         \t\t//Convert html string into jsPDF instances\n\t\t    doc.save('APA.pdf');\n        }\n        if(fileFormat === 'docx'){\n            var blob = new Blob(['\\ufeff', apastr], {\t\t\t\t                    \t\t//converts html string into blob(Binary Large Object) of type msword\n                type: 'application/msword'\n                });\n                var url = 'data:application/vnd.ms-word;charset=utf-8,' + encodeURIComponent(apastr);\n                var filename = \"APA.docx\";\t\t\t\t\t\t                                 \t\t//file is downloaded as MLA.docx, user can change it while downloading\n                var downloadLink = document.createElement(\"a\");\t\t\t\n                document.body.appendChild(downloadLink);\n                if(navigator.msSaveOrOpenBlob ){\n                    navigator.msSaveOrOpenBlob(blob, filename);\n                }else{\n                    downloadLink.href = url;\n                    downloadLink.download = filename;\n                    downloadLink.click();\n                }\n                document.body.removeChild(downloadLink);\n        }\n        if(fileFormat === 'html'){\n            var element = document.createElement('a');\n            element.setAttribute('href', 'data:text/plain;charset=utf-8,' + encodeURIComponent(apastr));\n            element.setAttribute('download', \"APA.html\");\n            element.style.display = 'none';\n            document.body.appendChild(element);\n            element.click();\n            document.body.removeChild(element);\n        }\n    }\n    if(bibFormat === 'ieee'){\n        var ieeestr      = \"<html><body style= 'font-family:Times New Roman; font-size: 11px'>\";   //ieee formatted html string                                                                       //str is a html string\n        for(var i=0; i<JsonData.length; i++){\n            ieeestr+= \"<p>\"  \n            ieeestr += '['+(i+1).toString()+\"] \";\n            var authorsList = JsonData[i].authors.split(\",\");\n\t\t\tfor(var j= 0; j<authorsList.length; j++){\n                var authorstr = authorsList[j];\n                var authorstrList = authorstr.split(' ');\n                if(authorstrList.length > 1){\n                    if(authorstr[0] != ' '){\n                        ieeestr += authorstrList[0][0]+\". \";\n                        var star = 1; \n                    }               \n                    else{\n                        ieeestr += authorstrList[1][0]+\". \";\n                        var star = 2;\n                    }\n                }\n                else\n                    ieeestr += authorstrList[0]+\". \";\n                for(var abc = star; abc <= authorstrList.length -2 ; abc++){\n                    ieeestr += authorstrList[abc][0]+'. ';\n                }\n                ieeestr += authorstrList[authorstrList.length - 1];\n\t\t\t\tif(j == authorsList.length - 2){\n\t\t\t\t\tieeestr += \", and \";\n\t\t\t\t}\n\t\t\t\telse if(j < authorsList.length - 2){\n\t\t\t\t\tieeestr += \", \";\n\t\t\t\t}\n\t\t\t}\n            ieeestr += \", <i>\"+JsonData[i].title+\", </i>\";\n            ieeestr += JsonData[i].city + \": \" + JsonData[i].publisher;\n            ieeestr += \", \"+JsonData[i].year;\n            ieeestr += \"</p>\";\n        }\n        ieeestr += \"</body></html>\" ;\n        if(fileFormat === 'pdf'){\n            var doc = new jsPDF('p', 'pt', 'letter');\n\t\t    doc.fromHTML(ieeestr, 45, 30, {width: 517});\t\t\t\t\t                  \t         \t\t//Convert html string into jsPDF instances\n\t\t    doc.save('IEEE.pdf');\n        }\n        if(fileFormat === 'docx'){\n            var blob = new Blob(['\\ufeff', ieeestr], {\t\t\t\t                    \t\t//converts html string into blob(Binary Large Object) of type msword\n                type: 'application/msword'\n                });\n                var url = 'data:application/vnd.ms-word;charset=utf-8,' + encodeURIComponent(ieeestr);\n                var filename = \"IEEE.docx\";\t\t\t\t\t\t                                 \t\t//file is downloaded as MLA.docx, user can change it while downloading\n                var downloadLink = document.createElement(\"a\");\t\t\t\n                document.body.appendChild(downloadLink);\n                if(navigator.msSaveOrOpenBlob ){\n                    navigator.msSaveOrOpenBlob(blob, filename);\n                }else{\n                    downloadLink.href = url;\n                    downloadLink.download = filename;\n                    downloadLink.click();\n                }\n                document.body.removeChild(downloadLink);\n        }\n        if(fileFormat === 'html'){\n            var element = document.createElement('a');\n            element.setAttribute('href', 'data:text/plain;charset=utf-8,' + encodeURIComponent(ieeestr));\n            element.setAttribute('download', \"IEEE.html\");\n            element.style.display = 'none';\n            document.body.appendChild(element);\n            element.click();\n            document.body.removeChild(element);\n        }\n    }\n}\n\nexport default downloader;"]},"metadata":{},"sourceType":"module"}